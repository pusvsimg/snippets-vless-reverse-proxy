# Cloudflare 双功能代理节点部署教程

本项目旨在提供一个稳定、高效且免费的 Cloudflare 代理节点部署方案。脚本经过优化，具有独特的双重功能：

* **高性能 WebSocket 代理**：作为核心功能，为您的客户端提供稳定快速的代理服务。
* **富有意义的静态主页**：当通过浏览器直接访问节点时，会展示一个**支持乌克兰、谴责侵略**的静态页面，用于表明立场和访问验证。

您可以根据自己的偏好，选择以下两种免费的部署方法。

* **🚀 Cloudflare Workers**: 性能更佳，速度更快，为推荐方案。
* **📄 Cloudflare Pages**: 操作最简化，通过 Fork 仓库即可一键部署。

---

## ✨ 功能特性

* **双重功能**：同一个域名，既是代理节点，也是一个传达明确信息的静态网页。
* **明确立场**：默认主页旗帜鲜明地支持乌克兰，利用技术空间发声。
* **完全免费**：充分利用 Cloudflare 的免费套餐，无需任何服务器费用。
* **性能卓越**：部署在全球 Cloudflare 边缘网络，延迟低，速度快。
* **高度自定义**：您可以轻易修改 `worker.js` 文件中的 HTML 代码，打造属于您自己的主页。

---

## 🌐 关于静态主页

这个 Worker 脚本的一大特色是它的“双重身份”。当您在浏览器中直接访问部署好的域名时，它不会显示任何错误或空白页面，而是会呈现一个精心设计、功能完整的静态主页。

### 默认主题：与乌克兰站在一起 (Stand With Ukraine)

本项目的默认主页是一个明确表达对乌克兰支持、并谴责侵略行径的页面。它旨在利用网络空间发声，传达对和平与正义的追求。页面核心信息如下：

> #### 我们与乌克兰站在一起
>
> 我们坚定地支持乌克兰的主权和人民。我们强烈谴责俄罗斯联邦发动的无端侵略及其持续犯下的战争罪行。
>
> 愿自由与和平早日重归这片勇敢的土地。
>
> **#StandWithUkraine**

### 为什么这很有用？

* **访问验证**：您可以轻松通过浏览器检查您的 Worker 和域名是否已成功部署并可以公开访问。
* **有效伪装**：使您的域名看起来像一个正常的、有内容的网站，有助于在某些网络环境中隐藏其主要的代理用途。
* **表达立场**：您可以利用这个页面传达您想分享的任何信息或立场，使其不仅仅是一个工具。

### 如何自定义页面？

页面的所有内容都包含在 `worker.js` 文件顶部的 `const html = \`...\`;` 变量中。您只需编辑这个 HTML 字符串，就可以轻松地将其替换为您自己的网站内容。

---

## 🚀 方法一：通过 Cloudflare Workers 部署（性能最佳）

此方法能最大化发挥 Cloudflare 边缘网络的性能优势。

### 步骤 1: 准备 Worker 代码

直接复制本项目仓库中 `worker.js` 文件内的**所有代码**。

### 步骤 2: 创建并部署 Worker

1.  登录 Cloudflare 控制台，在左侧菜单中进入 **Workers & Pages**。
2.  点击 `Create application` > `Create Worker`。
3.  为您的 Worker 服务设置一个自定义名称（例如 `my-proxy-worker`），然后点击 **Deploy**。
4.  部署成功后，点击 **Edit code** 进入代码编辑器。
5.  **清空**编辑器中的所有默认代码，然后**粘贴** `worker.js` 的完整代码。
6.  点击 **Save and Deploy**，等待代码成功部署。

### 步骤 3: 绑定自定义域名 (必要步骤)

> **重要提示**：由于 Cloudflare 提供的 `workers.dev` 免费子域名已被广泛封锁，**必须绑定您自己的域名**才能确保节点在多数网络环境下可用。

1.  在 Worker 的管理页面，进入 **Triggers** 选项卡。
2.  在 **Custom Domains** 部分，点击 **Add custom domain**。
3.  输入您已经托管在 Cloudflare 上的域名（或子域名），例如 `proxy.yourdomain.com`，然后点击 **Add domain**。
4.  绑定成功后，您的节点就可以通过这个自定义域名使用了。

---

## 📄 方法二：通过 Cloudflare Pages 部署（操作简单）

此方法利用 GitHub 和 Cloudflare Pages 的集成，实现“Fork 即部署”，适合不熟悉代码操作的用户。

> **注意**：使用此方法前，请确保本仓库的 `worker.js` 文件已更新为您需要的代码。

### 步骤 1: Fork 本仓库

点击本仓库页面右上角的 **Fork** 按钮，将项目完整地复制到您自己的 GitHub 账户下。

### 步骤 2: 连接到 Cloudflare Pages

1.  登录 Cloudflare 控制台，进入 **Workers & Pages**。
2.  选择 `Create application` > `Pages` > `Connect to Git`。
3.  选择您刚刚 Fork 的仓库，然后点击 **Begin setup**。

### 步骤 3: 部署项目

1.  在部署页面，Cloudflare 会自动识别项目配置，您**无需修改任何构建设置**。
2.  直接滚动到页面底部，点击 **Save and Deploy**。
3.  等待几分钟，Cloudflare 将自动完成构建和部署。

---

## 🔗 获取订阅链接

部署完成后，您需要通过以下方式生成客户端可用的订阅链接。

**将下方链接模板中的 `您的域名` 替换为您在上面步骤中绑定的 Worker 自定义域名或 Pages 域名。**

#### 方式一：使用在线订阅生成器（推荐）

这是一个可视化的工具，能帮助您快速生成链接。

1.  打开订阅生成器网站：[https://bp.sub.cmliussss.net/](https://bp.sub.cmliussss.net/)
2.  在输入框中填入您的域名。
3.  点击“生成订阅链接”，然后复制生成的 URL 即可。

#### 方式二：手动拼接链接（备用）

如果您无法访问上面的网站，可以手动拼接。

* **链接模板**: `https://cfxr.eu.org/getSub?host=您的域名`

* **示例**: 如果您的域名是 `proxy.yourdomain.com`，那么手动拼接后的订阅链接就是：
    ```
    [https://cfxr.eu.org/getSub?host=proxy.yourdomain.com](https://cfxr.eu.org/getSub?host=proxy.yourdomain.com)
    ```

将拼接好的链接添加到您的代理客户端，即可开始使用。

---

## 🙏 致谢

* 本教程中推荐的在线订阅链接生成器由 [cmliu/CF-Workers-BPSUB](https://github.com/cmliu/CF-Workers-BPSUB) 项目提供支持，特此感谢。
